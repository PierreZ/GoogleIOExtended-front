<!--
@license
Copyright (c) 2015 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
-->

<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/paper-styles/typography.html">
<script src="https://cdn.socket.io/socket.io-1.4.5.js"></script>

<dom-module id="my-list">
  <template>
  <style>
  :host {
    display: block;

  }
  .tweet{
        border-bottom: 1px solid grey;
  }

  .user-twitter-img {
    width: 60px;
    height: 60px;
  }

  span {
    @apply(--paper-font-body1);
  }
  </style>

  <ul style="list-style-type:none;padding-left:5px;margin-top:0px">
    <template is="dom-repeat" items="{{items}}">
      <li class="tweet">
        <div>
          <div>
            <img class="user-twitter-img" src="[[item.user.profile_image_url_https]]" style="float:right"/>

            <h4>@[[item.user.screen_name]]</h4>
          </div>
          <h4></h4>
          <p>
            [[item.text]]
          </p>
        </div>
      </li>
    </template>
  </ul>
</template>
<script>
(function() {
  'use strict';

  Polymer({
    is: 'my-list',

    properties: {
      items: {
        type: Array,
        notify: true,
      }
    },
    add: function(tweet) {
      this.unshift('items', tweet);
      if(this.items.length > 100) {
        console.log("splicing")
        this.splice('items', 100, 1);
      }
    },
    ready: function() {
      this.items = [
      ];
      var socket = io.connect('app-fecdbcce-3610-477a-a274-8bdc61c99b8b.cleverapps.io')
      socket.on('connect', function () {
        socket.on('tweet', function (data) {
          console.log(data)
          document.querySelector("my-list").add(data);
        });
      });
    },
  })
})();
</script>
</dom-module>
